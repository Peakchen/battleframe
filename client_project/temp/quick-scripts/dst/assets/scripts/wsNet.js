
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/wsNet.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'f5f02ULtVhD47PNH08lZ5uR', 'wsNet');
// scripts/wsNet.js

"use strict";

/**
 * websocket 
 */
var Global = require("common"); //心跳检测


var HeartCheck = {
  timeout: 50000,
  //50秒 稍微比服务器小一点，让服务器网络波动有个缓冲时间
  svrtimeout: 60000,
  //60秒
  timeoutObj: null,
  serverTimeoutObj: null,
  disconnectioned: false,
  reconnectTimeoutobj: null,
  reset: function reset() {
    clearTimeout(this.timeoutObj);
    clearTimeout(this.serverTimeoutObj);
    return this;
  },
  startHeartBeat: function startHeartBeat() {
    var self = this;
    this.timeoutObj = setTimeout(function () {
      //这里发送一个心跳，后端收到后，返回一个心跳消息，onmessage拿到返回的心跳就说明连接正常
      cc.log("send heart beat...");

      if (Global.ws == null) {
        return;
      }

      var buff = new ArrayBuffer(12);
      var data = new Uint32Array(buff);
      data[0] = Global.MID_HeartBeat; //消息ID

      data[1] = 1; //消息长度

      data[2] = 0; //anything 随意填充一个数

      Global.ws.send(data);
      self.serverTimeoutObj = setTimeout(function () {
        //心跳超时主动断开
        cc.log("close connection...");

        if (Global.ws == null) {
          return;
        }

        Global.ws.close(); //self.disconnectioned = true
      }, self.svrtimeout);
    }, this.timeout);
  },
  hasDisconnected: function hasDisconnected() {
    return this.disconnectioned;
  },
  stopReconnectTimer: function stopReconnectTimer() {
    //cc.log("close reconnectTimeout...")
    clearTimeout(this.reconnectTimeoutobj);
  }
};
/**
 * 消息回复处理
 */

var MessageStateFunc = {
  /**
   * 消息解析 
   * 0: 消息id
   * 1：消息长度
   * 2：sessionid
   * 3：nodex x坐标正负标记
   * 4：nodex x坐标值
   * 5：nodey y坐标正负标记
   * 6：nodey y坐标值 
   */
  onlogin: function onlogin(data) {
    if (data[2] == 1) {
      Global.mySessionId = data[3];
    } else {
      return;
    }

    cc.log("ws message MID_login: ", data[2], data[3], data[4], data[5], data[6], data[7], data[8]);
    Global.LoginSucc = data[2];
    var nodex = data[5];
    var nodey = data[7];

    if (data[4] == 2) {
      nodex = 0 - nodex;
    }

    if (data[6] == 2) {
      nodey = 0 - nodey;
    }

    Global.MosterPosX = nodex;
    Global.MosterPosY = nodey;
    Global.MonsterScore = data[8];
  },
  onlogout: function onlogout(data) {
    var key = data[2].toString();
    cc.log("ws message MID_logout, sessionid: ", key);
    Global.DelPlayerIds.push(key);
    Global.PlayerSessionMap["delete"](key);
  },
  onmove: function onmove(data) {
    cc.log("ws message MID_move: ", data[1], data[2], data[3], data[4], data[5], data[6]);
    var key = data[6].toString();
    var nodex = data[3];
    var nodey = data[5];

    if (data[2] == 2) {
      nodex = 0 - nodex;
    }

    if (data[4] == 2) {
      nodey = 0 - nodey;
    }

    var playerProp = {
      sessionId: data[6],
      nodex: nodex,
      nodey: nodey
    };

    if (Global.PlayerSessionMap.has(key) == false) {
      Global.PlayerSessionMap.set(key, playerProp);
    }

    Global.NewplayerMap.set(key, playerProp);
    Global.newPlayerIds.push(key); //cc.log("MID_move purple monsters: ", Global.newPlayerIds.length, key, Global.NewplayerMap.has(key))
  },
  onBump: function onBump(data) {
    /**
     *  0: 消息ID
        1：消息长度
        2: 成功失败标志 (失败则只需要前三个字段)
        3: 星星x坐标正负标志
        4: 星星x坐标
        5：星星y坐标正负标志
        6：星星y坐标
        */
    if (data[2] == 0) {
      //失败
      cc.log("ws message MID_Bump fail ... ");
      return;
    }

    cc.log("ws message MID_Bump: ", data[1], data[2], data[3], data[4], data[5], data[6], data[7]);
    var nodex = data[4];
    var nodey = data[6];

    if (data[3] == 2) {
      nodex = 0 - nodex;
    }

    if (data[5] == 2) {
      nodey = 0 - nodey;
    }

    Global.BumpedPlayerId = data[7];
    var starProp = {
      nodex: nodex,
      nodey: nodey
    };
    Global.newStarPos.set(Global.newStarKey, starProp);
  },
  onHeartBeat: function onHeartBeat(data) {
    cc.log("ws message MID_HeartBeat...");
  },
  onStarBorn: function onStarBorn(data) {
    cc.log("ws message MID_StarBorn: ", data[2], data[3], data[4], data[5]);
    /**
     *  0: 消息ID
        1：消息长度
        2: 星星x坐标正负标志
        3: 星星x坐标
        4：星星y坐标正负标志
        5：星星y坐标
     */

    var nodex = data[3];
    var nodey = data[5];

    if (data[2] == 2) {
      nodex = 0 - nodex;
    }

    if (data[4] == 2) {
      nodey = 0 - nodey;
    }

    var starProp = {
      nodex: nodex,
      nodey: nodey
    };
    Global.newStarPos.set(Global.newStarKey, starProp);
  },
  onGM: function onGM(data) {
    cc.log("ws message MID_GM...");
  },
  Online4Other: function Online4Other(data) {
    cc.log("ws message MID_Online4Other: ", data[2], data[3], data[4], data[5], data[6]);
    var key = data[6].toString();
    var nodex = data[3];
    var nodey = data[5];

    if (data[2] == 2) {
      nodex = 0 - nodex;
    }

    if (data[4] == 2) {
      nodey = 0 - nodey;
    }

    cc.log("pos: ", nodex, nodey);
    var playerProp = {
      sessionId: data[6],
      nodex: nodex,
      nodey: nodey
    };

    if (Global.PlayerSessionMap.has(key) == false) {
      Global.PlayerSessionMap.set(key, playerProp);
    }

    Global.NewplayerMap.set(key, playerProp);
    Global.newPlayerIds.push(key);
    Global.syncOnline4Other = true;
  },
  onRegister: function onRegister(data) {
    cc.log("ws message MID_Register: ", data[2]);
    Global.RegisterSucc = data[2];
  },

  /**
   * 
   * @param {*} data only request, not response...
   */
  onSyncPos: function onSyncPos(data) {
    cc.log("ws message MID_SyncPos...");
  },
  onMonsterInfo: function onMonsterInfo(data) {
    cc.log("ws message MID_MonsterInfo: ", data[2], data[3]);
    Global.MonsterScore = data[3];
  },
  onLogicFrameSync: function onLogicFrameSync(data) {
    cc.log("ws message MID_LogicFrameSync: ", data[2], data[3]);
  }
};
cc.Class({
  //extends: cc.Component,

  /*
  readyState:
      CONNECTING 0
      OPEN       1
      CLOSING    2
      CLOSED     3
  */
  CanSendMsg: function CanSendMsg() {
    if (Global.ws == null) {
      return false;
    }

    return Global.ws.readyState == WebSocket.CONNECTING || Global.ws.readyState == WebSocket.OPEN;
  },
  swConnect: function swConnect() {
    if (Global.ws != null) {
      //return
      //cc.log("readyState: ", Global.ws.readyState)
      if (Global.ws.readyState == WebSocket.CONNECTING || Global.ws.readyState == WebSocket.OPEN) {
        //已经连上就不必再连
        return;
      }
    }

    var self = this;
    cc.log("addr: ", Global.wsAddr, Global.ws == null);
    var ws = new WebSocket(Global.wsAddr);

    ws.onopen = function (e) {
      cc.log("ws open: ", ws.readyState); //发送心跳

      HeartCheck.reset().startHeartBeat();
    };

    ws.onmessage = function (e) {
      var data = new Uint32Array(e.data);
      var msgid = data[0];

      switch (msgid) {
        case Global.MID_login:
          MessageStateFunc.onlogin(data);
          break;

        case Global.MID_logout:
          MessageStateFunc.onlogout(data);
          break;

        case Global.MID_move:
          MessageStateFunc.onmove(data);
          break;

        case Global.MID_Bump:
          MessageStateFunc.onBump(data);
          break;

        case Global.MID_HeartBeat:
          MessageStateFunc.onHeartBeat(data);
          break;

        case Global.MID_StarBorn:
          MessageStateFunc.onStarBorn(data);
          break;

        case Global.MID_GM:
          MessageStateFunc.onGM(data);
          break;

        case Global.MID_Online4Other:
          MessageStateFunc.Online4Other(data);
          break;

        case Global.MID_Register:
          MessageStateFunc.onRegister(data);
          break;

        case Global.MID_SyncPos:
          MessageStateFunc.onSyncPos(data);
          break;

        case Global.MID_MonsterInfo:
          MessageStateFunc.onMonsterInfo(data);
          break;

        case Global.MID_LogicFrameSync:
          MessageStateFunc.onLogicFrameSync(data);
          break;

        default:
          cc.log("未知 消息id: ", msgid);
      } //发送心跳


      HeartCheck.reset().startHeartBeat();
    };

    ws.onerror = function (e) {
      cc.log("ws error: ", ws.readyState); //Global.ws = null

      if (HeartCheck.hasDisconnected() == false) {
        HeartCheck.stopReconnectTimer();
        HeartCheck.reconnectTimeoutobj = setTimeout(function () {
          self.swConnect();
        }, 1000);
      } else {
        HeartCheck.stopReconnectTimer();
      }
    };

    ws.onclose = function (e) {
      cc.log("ws close: ", ws.readyState); //Global.ws = null

      if (HeartCheck.hasDisconnected() == false) {
        HeartCheck.stopReconnectTimer();
        HeartCheck.reconnectTimeoutobj = setTimeout(function () {
          self.swConnect();
        }, 1000);
      } else {
        HeartCheck.stopReconnectTimer();
      }
    };

    cc.log("global ws init, state: ", ws.readyState);
    Global.ws = ws;
  },

  /**
   * 
   * @param {*} data  具体数据, 1：长度，2：是否广播，3：... 具体消息数据
   */
  sendwsmessage: function sendwsmessage(data) {
    if (Global.ws == null) {
      return;
    }

    if (Global.ws != null) {
      if (Global.ws.readyState == WebSocket.CLOSED || Global.ws.readyState == WebSocket.CLOSING) {
        //正在断开或者已经断开，则不能发送消息
        return;
      }
    } //cc.log("ws sendwsmessage: ", Global.ws.readyState)


    Global.ws.send(data);
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcd3NOZXQuanMiXSwibmFtZXMiOlsiR2xvYmFsIiwicmVxdWlyZSIsIkhlYXJ0Q2hlY2siLCJ0aW1lb3V0Iiwic3ZydGltZW91dCIsInRpbWVvdXRPYmoiLCJzZXJ2ZXJUaW1lb3V0T2JqIiwiZGlzY29ubmVjdGlvbmVkIiwicmVjb25uZWN0VGltZW91dG9iaiIsInJlc2V0IiwiY2xlYXJUaW1lb3V0Iiwic3RhcnRIZWFydEJlYXQiLCJzZWxmIiwic2V0VGltZW91dCIsImNjIiwibG9nIiwid3MiLCJidWZmIiwiQXJyYXlCdWZmZXIiLCJkYXRhIiwiVWludDMyQXJyYXkiLCJNSURfSGVhcnRCZWF0Iiwic2VuZCIsImNsb3NlIiwiaGFzRGlzY29ubmVjdGVkIiwic3RvcFJlY29ubmVjdFRpbWVyIiwiTWVzc2FnZVN0YXRlRnVuYyIsIm9ubG9naW4iLCJteVNlc3Npb25JZCIsIkxvZ2luU3VjYyIsIm5vZGV4Iiwibm9kZXkiLCJNb3N0ZXJQb3NYIiwiTW9zdGVyUG9zWSIsIk1vbnN0ZXJTY29yZSIsIm9ubG9nb3V0Iiwia2V5IiwidG9TdHJpbmciLCJEZWxQbGF5ZXJJZHMiLCJwdXNoIiwiUGxheWVyU2Vzc2lvbk1hcCIsIm9ubW92ZSIsInBsYXllclByb3AiLCJzZXNzaW9uSWQiLCJoYXMiLCJzZXQiLCJOZXdwbGF5ZXJNYXAiLCJuZXdQbGF5ZXJJZHMiLCJvbkJ1bXAiLCJCdW1wZWRQbGF5ZXJJZCIsInN0YXJQcm9wIiwibmV3U3RhclBvcyIsIm5ld1N0YXJLZXkiLCJvbkhlYXJ0QmVhdCIsIm9uU3RhckJvcm4iLCJvbkdNIiwiT25saW5lNE90aGVyIiwic3luY09ubGluZTRPdGhlciIsIm9uUmVnaXN0ZXIiLCJSZWdpc3RlclN1Y2MiLCJvblN5bmNQb3MiLCJvbk1vbnN0ZXJJbmZvIiwib25Mb2dpY0ZyYW1lU3luYyIsIkNsYXNzIiwiQ2FuU2VuZE1zZyIsInJlYWR5U3RhdGUiLCJXZWJTb2NrZXQiLCJDT05ORUNUSU5HIiwiT1BFTiIsInN3Q29ubmVjdCIsIndzQWRkciIsIm9ub3BlbiIsImUiLCJvbm1lc3NhZ2UiLCJtc2dpZCIsIk1JRF9sb2dpbiIsIk1JRF9sb2dvdXQiLCJNSURfbW92ZSIsIk1JRF9CdW1wIiwiTUlEX1N0YXJCb3JuIiwiTUlEX0dNIiwiTUlEX09ubGluZTRPdGhlciIsIk1JRF9SZWdpc3RlciIsIk1JRF9TeW5jUG9zIiwiTUlEX01vbnN0ZXJJbmZvIiwiTUlEX0xvZ2ljRnJhbWVTeW5jIiwib25lcnJvciIsIm9uY2xvc2UiLCJzZW5kd3NtZXNzYWdlIiwiQ0xPU0VEIiwiQ0xPU0lORyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7O0FBSUEsSUFBSUEsTUFBTSxHQUFHQyxPQUFPLENBQUMsUUFBRCxDQUFwQixFQUVBOzs7QUFDQSxJQUFJQyxVQUFVLEdBQUc7QUFDYkMsRUFBQUEsT0FBTyxFQUFFLEtBREk7QUFDRztBQUNoQkMsRUFBQUEsVUFBVSxFQUFFLEtBRkM7QUFFTTtBQUNuQkMsRUFBQUEsVUFBVSxFQUFFLElBSEM7QUFJYkMsRUFBQUEsZ0JBQWdCLEVBQUUsSUFKTDtBQUtiQyxFQUFBQSxlQUFlLEVBQUUsS0FMSjtBQU1iQyxFQUFBQSxtQkFBbUIsRUFBRSxJQU5SO0FBUWJDLEVBQUFBLEtBQUssRUFBRSxpQkFBVztBQUNkQyxJQUFBQSxZQUFZLENBQUMsS0FBS0wsVUFBTixDQUFaO0FBQ0FLLElBQUFBLFlBQVksQ0FBQyxLQUFLSixnQkFBTixDQUFaO0FBQ0EsV0FBTyxJQUFQO0FBQ0gsR0FaWTtBQWNiSyxFQUFBQSxjQUFjLEVBQUUsMEJBQVc7QUFDdkIsUUFBSUMsSUFBSSxHQUFHLElBQVg7QUFDQSxTQUFLUCxVQUFMLEdBQWtCUSxVQUFVLENBQUMsWUFBVztBQUNwQztBQUNBQyxNQUFBQSxFQUFFLENBQUNDLEdBQUgsQ0FBTyxvQkFBUDs7QUFDQSxVQUFJZixNQUFNLENBQUNnQixFQUFQLElBQWEsSUFBakIsRUFBdUI7QUFDbkI7QUFDSDs7QUFFRCxVQUFJQyxJQUFJ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dCI6WyIvKipcclxuICogd2Vic29ja2V0IFxyXG4gKi9cclxuXHJcbmxldCBHbG9iYWwgPSByZXF1aXJlKFwiY29tbW9uXCIpXHJcblxyXG4vL+W/g+i3s+ajgOa1i1xyXG52YXIgSGVhcnRDaGVjayA9IHtcclxuICAgIHRpbWVvdXQ6IDUwMDAwLCAvLzUw56eSIOeojeW+ruavlOacjeWKoeWZqOWwj+S4gOeCue+8jOiuqeacjeWKoeWZqOe9kee7nOazouWKqOacieS4que8k+WGsuaXtumXtFxyXG4gICAgc3ZydGltZW91dDogNjAwMDAsIC8vNjDnp5JcclxuICAgIHRpbWVvdXRPYmo6IG51bGwsXHJcbiAgICBzZXJ2ZXJUaW1lb3V0T2JqOiBudWxsLFxyXG4gICAgZGlzY29ubmVjdGlvbmVkOiBmYWxzZSxcclxuICAgIHJlY29ubmVjdFRpbWVvdXRvYmo6IG51bGwsXHJcblxyXG4gICAgcmVzZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRPYmopO1xyXG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNlcnZlclRpbWVvdXRPYmopO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSxcclxuXHJcbiAgICBzdGFydEhlYXJ0QmVhdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMudGltZW91dE9iaiA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8v6L+Z6YeM5Y+R6YCB5LiA5Liq5b+D6Lez77yM5ZCO56uv5pS25Yiw5ZCO77yM6L+U5Zue5LiA5Liq5b+D6Lez5raI5oGv77yMb25tZXNzYWdl5ou/5Yiw6L+U5Zue55qE5b+D6Lez5bCx6K+05piO6L+e5o6l5q2j5bi4XHJcbiAgICAgICAgICAgIGNjLmxvZyhcInNlbmQgaGVhcnQgYmVhdC4uLlwiKVxyXG4gICAgICAgICAgICBpZiAoR2xvYmFsLndzID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICB9IFxyXG5cclxuICAgICAgICAgICAgdmFyIGJ1ZmYgPSBuZXcgQXJyYXlCdWZmZXIoMTIpXHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gbmV3IFVpbnQzMkFycmF5KGJ1ZmYpXHJcbiAgICBcclxuICAgICAgICAgICAgZGF0YVswXSA9IEdsb2JhbC5NSURfSGVhcnRCZWF0IC8v5raI5oGvSURcclxuICAgICAgICAgICAgZGF0YVsxXSA9IDEgLy/mtojmga/plb/luqZcclxuICAgICAgICAgICAgZGF0YVsyXSA9IDAgLy9hbnl0aGluZyDpmo/mhI/loavlhYXkuIDkuKrmlbBcclxuXHJcbiAgICAgICAgICAgIEdsb2JhbC53cy5zZW5kKGRhdGEpO1xyXG4gICAgICAgICAgICBzZWxmLnNlcnZlclRpbWVvdXRPYmogPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyAvL+W/g+i3s+i2heaXtuS4u+WKqOaWreW8gFxyXG4gICAgICAgICAgICAgICAgY2MubG9nKFwiY2xvc2UgY29ubmVjdGlvbi4uLlwiKVxyXG4gICAgICAgICAgICAgICAgaWYgKEdsb2JhbC53cyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICAgICAgR2xvYmFsLndzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAvL3NlbGYuZGlzY29ubmVjdGlvbmVkID0gdHJ1ZVxyXG4gICAgICAgICAgICB9LCBzZWxmLnN2cnRpbWVvdXQpXHJcbiAgICAgICAgfSwgdGhpcy50aW1lb3V0KVxyXG4gICAgfSxcclxuXHJcbiAgICBoYXNEaXNjb25uZWN0ZWQ6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlzY29ubmVjdGlvbmVkXHJcbiAgICB9LFxyXG5cclxuICAgIHN0b3BSZWNvbm5lY3RUaW1lcjogZnVuY3Rpb24oKXtcclxuICAgICAgICAvL2NjLmxvZyhcImNsb3NlIHJlY29ubmVjdFRpbWVvdXQuLi5cIilcclxuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5yZWNvbm5lY3RUaW1lb3V0b2JqKTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOa2iOaBr+WbnuWkjeWkhOeQhlxyXG4gKi9cclxudmFyIE1lc3NhZ2VTdGF0ZUZ1bmMgPSB7XHJcbiAgICAvKipcclxuICAgICAqIOa2iOaBr+ino+aekCBcclxuICAgICAqIDA6IOa2iOaBr2lkXHJcbiAgICAgKiAx77ya5raI5oGv6ZW/5bqmXHJcbiAgICAgKiAy77yac2Vzc2lvbmlkXHJcbiAgICAgKiAz77yabm9kZXggeOWdkOagh+ato+i0n+agh+iusFxyXG4gICAgICogNO+8mm5vZGV4IHjlnZDmoIflgLxcclxuICAgICAqIDXvvJpub2RleSB55Z2Q5qCH5q2j6LSf5qCH6K6wXHJcbiAgICAgKiA277yabm9kZXkgeeWdkOagh+WAvCBcclxuICAgICAqL1xyXG4gICAgb25sb2dpbjogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChkYXRhWzJdID09IDEpIHtcclxuICAgICAgICAgICAgR2xvYmFsLm15U2Vzc2lvbklkID0gZGF0YVszXVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNjLmxvZyhcIndzIG1lc3NhZ2UgTUlEX2xvZ2luOiBcIiwgZGF0YVsyXSwgZGF0YVszXSwgZGF0YVs0XSwgZGF0YVs1XSwgZGF0YVs2XSwgZGF0YVs3XSwgZGF0YVs4XSlcclxuICAgICAgICBHbG9iYWwuTG9naW5TdWNjID0gZGF0YVsyXVxyXG4gICAgICAgIHZhciBub2RleCA9IGRhdGFbNV1cclxuICAgICAgICB2YXIgbm9kZXkgPSBkYXRhWzddXHJcbiAgICAgICAgaWYgKGRhdGFbNF0gPT0gMil7XHJcbiAgICAgICAgICAgIG5vZGV4ID0gMCAtIG5vZGV4XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkYXRhWzZdID09IDIpe1xyXG4gICAgICAgICAgICBub2RleSA9IDAgLSBub2RleVxyXG4gICAgICAgIH1cclxuICAgICAgICBHbG9iYWwuTW9zdGVyUG9zWCA9IG5vZGV4XHJcbiAgICAgICAgR2xvYmFsLk1vc3RlclBvc1kgPSBub2RleVxyXG4gICAgICAgIEdsb2JhbC5Nb25zdGVyU2NvcmUgPSBkYXRhWzhdXHJcbiAgICB9LFxyXG5cclxuICAgIG9ubG9nb3V0OiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgdmFyIGtleSA9IGRhdGFbMl0udG9TdHJpbmcoKVxyXG4gICAgICAgIGNjLmxvZyhcIndzIG1lc3NhZ2UgTUlEX2xvZ291dCwgc2Vzc2lvbmlkOiBcIiwga2V5KVxyXG4gICAgICAgIEdsb2JhbC5EZWxQbGF5ZXJJZHMucHVzaChrZXkpXHJcbiAgICAgICAgR2xvYmFsLlBsYXllclNlc3Npb25NYXAuZGVsZXRlKGtleSlcclxuICAgIH0sXHJcblxyXG4gICAgb25tb3ZlOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgY2MubG9nKFwid3MgbWVzc2FnZSBNSURfbW92ZTogXCIsIGRhdGFbMV0sIGRhdGFbMl0sIGRhdGFbM10sIGRhdGFbNF0sIGRhdGFbNV0sIGRhdGFbNl0pXHJcbiAgICAgICAgdmFyIGtleSA9IGRhdGFbNl0udG9TdHJpbmcoKVxyXG4gICAgICAgIHZhciBub2RleCA9IGRhdGFbM11cclxuICAgICAgICB2YXIgbm9kZXkgPSBkYXRhWzVdXHJcbiAgICAgICAgaWYgKGRhdGFbMl0gPT0gMil7XHJcbiAgICAgICAgICAgIG5vZGV4ID0gMCAtIG5vZGV4XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkYXRhWzRdID09IDIpe1xyXG4gICAgICAgICAgICBub2RleSA9IDAgLSBub2RleVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcGxheWVyUHJvcCA9IHtcclxuICAgICAgICAgICAgc2Vzc2lvbklkOiBkYXRhWzZdLFxyXG4gICAgICAgICAgICBub2RleDogbm9kZXgsXHJcbiAgICAgICAgICAgIG5vZGV5OiBub2RleVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoR2xvYmFsLlBsYXllclNlc3Npb25NYXAuaGFzKGtleSkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgR2xvYmFsLlBsYXllclNlc3Npb25NYXAuc2V0KGtleSwgcGxheWVyUHJvcClcclxuICAgICAgICB9XHJcbiAgICAgICAgR2xvYmFsLk5ld3BsYXllck1hcC5zZXQoa2V5LCBwbGF5ZXJQcm9wKVxyXG4gICAgICAgIEdsb2JhbC5uZXdQbGF5ZXJJZHMucHVzaChrZXkpXHJcbiAgICAgICAgLy9jYy5sb2coXCJNSURfbW92ZSBwdXJwbGUgbW9uc3RlcnM6IFwiLCBHbG9iYWwubmV3UGxheWVySWRzLmxlbmd0aCwga2V5LCBHbG9iYWwuTmV3cGxheWVyTWFwLmhhcyhrZXkpKVxyXG4gICAgfSxcclxuXHJcbiAgICBvbkJ1bXA6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogIDA6IOa2iOaBr0lEXHJcbiAgICAgICAgICAgIDHvvJrmtojmga/plb/luqZcclxuICAgICAgICAgICAgMjog5oiQ5Yqf5aSx6LSl5qCH5b+XICjlpLHotKXliJnlj6rpnIDopoHliY3kuInkuKrlrZfmrrUpXHJcbiAgICAgICAgICAgIDM6IOaYn+aYn3jlnZDmoIfmraPotJ/moIflv5dcclxuICAgICAgICAgICAgNDog5pif5pifeOWdkOagh1xyXG4gICAgICAgICAgICA177ya5pif5pifeeWdkOagh+ato+i0n+agh+W/l1xyXG4gICAgICAgICAgICA277ya5pif5pifeeWdkOagh1xyXG4gICAgICAgICAgICAqL1xyXG5cclxuICAgICAgICBpZiAoZGF0YVsyXSA9PSAwKXsgLy/lpLHotKVcclxuICAgICAgICAgICAgY2MubG9nKFwid3MgbWVzc2FnZSBNSURfQnVtcCBmYWlsIC4uLiBcIilcclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNjLmxvZyhcIndzIG1lc3NhZ2UgTUlEX0J1bXA6IFwiLCBkYXRhWzFdLCBkYXRhWzJdLCBkYXRhWzNdLCBkYXRhWzRdLCBkYXRhWzVdLCBkYXRhWzZdLCBkYXRhWzddKVxyXG5cclxuICAgICAgICB2YXIgbm9kZXggPSBkYXRhWzRdXHJcbiAgICAgICAgdmFyIG5vZGV5ID0gZGF0YVs2XVxyXG4gICAgICAgIGlmIChkYXRhWzNdID09IDIpe1xyXG4gICAgICAgICAgICBub2RleCA9IDAgLSBub2RleFxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGF0YVs1XSA9PSAyKXtcclxuICAgICAgICAgICAgbm9kZXkgPSAwIC0gbm9kZXlcclxuICAgICAgICB9XHJcbiAgICAgICAgR2xvYmFsLkJ1bXBlZFBsYXllcklkID0gZGF0YVs3XVxyXG4gICAgICAgIHZhciBzdGFyUHJvcCA9IHtcclxuICAgICAgICAgICAgbm9kZXg6IG5vZGV4LFxyXG4gICAgICAgICAgICBub2RleTogbm9kZXlcclxuICAgICAgICB9XHJcbiAgICAgICAgR2xvYmFsLm5ld1N0YXJQb3Muc2V0KEdsb2JhbC5uZXdTdGFyS2V5LCBzdGFyUHJvcClcclxuICAgIH0sXHJcblxyXG4gICAgb25IZWFydEJlYXQ6IGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgIGNjLmxvZyhcIndzIG1lc3NhZ2UgTUlEX0hlYXJ0QmVhdC4uLlwiKVxyXG4gICAgfSxcclxuXHJcbiAgICBvblN0YXJCb3JuOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgY2MubG9nKFwid3MgbWVzc2FnZSBNSURfU3RhckJvcm46IFwiLCBkYXRhWzJdLCBkYXRhWzNdLCBkYXRhWzRdLCBkYXRhWzVdKVxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICAwOiDmtojmga9JRFxyXG4gICAgICAgICAgICAx77ya5raI5oGv6ZW/5bqmXHJcbiAgICAgICAgICAgIDI6IOaYn+aYn3jlnZDmoIfmraPotJ/moIflv5dcclxuICAgICAgICAgICAgMzog5pif5pifeOWdkOagh1xyXG4gICAgICAgICAgICA077ya5pif5pifeeWdkOagh+ato+i0n+agh+W/l1xyXG4gICAgICAgICAgICA177ya5pif5pifeeWdkOagh1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBub2RleCA9IGRhdGFbM11cclxuICAgICAgICB2YXIgbm9kZXkgPSBkYXRhWzVdXHJcbiAgICAgICAgaWYgKGRhdGFbMl0gPT0gMil7XHJcbiAgICAgICAgICAgIG5vZGV4ID0gMCAtIG5vZGV4XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkYXRhWzRdID09IDIpe1xyXG4gICAgICAgICAgICBub2RleSA9IDAgLSBub2RleVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc3RhclByb3AgPSB7XHJcbiAgICAgICAgICAgIG5vZGV4OiBub2RleCxcclxuICAgICAgICAgICAgbm9kZXk6IG5vZGV5XHJcbiAgICAgICAgfVxyXG4gICAgICAgIEdsb2JhbC5uZXdTdGFyUG9zLnNldChHbG9iYWwubmV3U3RhcktleSwgc3RhclByb3ApXHJcbiAgICB9LFxyXG5cclxuICAgIG9uR006IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICBjYy5sb2coXCJ3cyBtZXNzYWdlIE1JRF9HTS4uLlwiKVxyXG4gICAgfSxcclxuXHJcbiAgICBPbmxpbmU0T3RoZXI6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICBjYy5sb2coXCJ3cyBtZXNzYWdlIE1JRF9PbmxpbmU0T3RoZXI6IFwiLCBkYXRhWzJdLCBkYXRhWzNdLCBkYXRhWzRdLCBkYXRhWzVdLCBkYXRhWzZdKVxyXG4gICAgICAgIHZhciBrZXkgPSBkYXRhWzZdLnRvU3RyaW5nKClcclxuICAgICAgICB2YXIgbm9kZXggPSBkYXRhWzNdXHJcbiAgICAgICAgdmFyIG5vZGV5ID0gZGF0YVs1XVxyXG4gICAgICAgIGlmIChkYXRhWzJdID09IDIpe1xyXG4gICAgICAgICAgICBub2RleCA9IDAgLSBub2RleFxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGF0YVs0XSA9PSAyKXtcclxuICAgICAgICAgICAgbm9kZXkgPSAwIC0gbm9kZXlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNjLmxvZyhcInBvczogXCIsIG5vZGV4LCBub2RleSlcclxuICAgICAgICB2YXIgcGxheWVyUHJvcCA9IHtcclxuICAgICAgICAgICAgc2Vzc2lvbklkOiBkYXRhWzZdLFxyXG4gICAgICAgICAgICBub2RleDogbm9kZXgsXHJcbiAgICAgICAgICAgIG5vZGV5OiBub2RleVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoR2xvYmFsLlBsYXllclNlc3Npb25NYXAuaGFzKGtleSkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgR2xvYmFsLlBsYXllclNlc3Npb25NYXAuc2V0KGtleSwgcGxheWVyUHJvcClcclxuICAgICAgICB9XHJcbiAgICAgICAgR2xvYmFsLk5ld3BsYXllck1hcC5zZXQoa2V5LCBwbGF5ZXJQcm9wKVxyXG4gICAgICAgIEdsb2JhbC5uZXdQbGF5ZXJJZHMucHVzaChrZXkpXHJcbiAgICAgICAgR2xvYmFsLnN5bmNPbmxpbmU0T3RoZXIgPSB0cnVlXHJcbiAgICB9LFxyXG5cclxuICAgIG9uUmVnaXN0ZXI6IGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgIGNjLmxvZyhcIndzIG1lc3NhZ2UgTUlEX1JlZ2lzdGVyOiBcIiwgZGF0YVsyXSlcclxuICAgICAgICBHbG9iYWwuUmVnaXN0ZXJTdWNjID0gZGF0YVsyXVxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHsqfSBkYXRhIG9ubHkgcmVxdWVzdCwgbm90IHJlc3BvbnNlLi4uXHJcbiAgICAgKi9cclxuICAgIG9uU3luY1BvczogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIGNjLmxvZyhcIndzIG1lc3NhZ2UgTUlEX1N5bmNQb3MuLi5cIilcclxuICAgIH0sXHJcblxyXG4gICAgb25Nb25zdGVySW5mbzogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIGNjLmxvZyhcIndzIG1lc3NhZ2UgTUlEX01vbnN0ZXJJbmZvOiBcIiwgZGF0YVsyXSwgZGF0YVszXSlcclxuICAgICAgICBHbG9iYWwuTW9uc3RlclNjb3JlID0gZGF0YVszXVxyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvZ2ljRnJhbWVTeW5jOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgY2MubG9nKFwid3MgbWVzc2FnZSBNSURfTG9naWNGcmFtZVN5bmM6IFwiLCBkYXRhWzJdLCBkYXRhWzNdKVxyXG4gICAgfVxyXG59XHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICAvL2V4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICAvKlxyXG4gICAgcmVhZHlTdGF0ZTpcclxuICAgICAgICBDT05ORUNUSU5HIDBcclxuICAgICAgICBPUEVOICAgICAgIDFcclxuICAgICAgICBDTE9TSU5HICAgIDJcclxuICAgICAgICBDTE9TRUQgICAgIDNcclxuICAgICovXHJcbiAgIFxyXG4gICAgQ2FuU2VuZE1zZzogZnVuY3Rpb24oKXtcclxuICAgICAgICBpZiAoR2xvYmFsLndzID09IG51bGwpe1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAoR2xvYmFsLndzLnJlYWR5U3RhdGUgPT0gV2ViU29ja2V0LkNPTk5FQ1RJTkcgfHwgR2xvYmFsLndzLnJlYWR5U3RhdGUgPT0gV2ViU29ja2V0Lk9QRU4pXHJcbiAgICB9LCBcclxuXHJcbiAgICBzd0Nvbm5lY3Q6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaWYgKEdsb2JhbC53cyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIC8vcmV0dXJuXHJcbiAgICAgICAgICAgIC8vY2MubG9nKFwicmVhZHlTdGF0ZTogXCIsIEdsb2JhbC53cy5yZWFkeVN0YXRlKVxyXG4gICAgICAgICAgICBpZiAoR2xvYmFsLndzLnJlYWR5U3RhdGUgPT0gV2ViU29ja2V0LkNPTk5FQ1RJTkcgfHwgR2xvYmFsLndzLnJlYWR5U3RhdGUgPT0gV2ViU29ja2V0Lk9QRU4pIHsgLy/lt7Lnu4/ov57kuIrlsLHkuI3lv4Xlho3ov55cclxuICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY2MubG9nKFwiYWRkcjogXCIsIEdsb2JhbC53c0FkZHIsIEdsb2JhbC53cyA9PSBudWxsKVxyXG4gICAgICAgIHZhciB3cyA9IG5ldyBXZWJTb2NrZXQoR2xvYmFsLndzQWRkcik7XHJcbiAgICAgICAgd3Mub25vcGVuID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBjYy5sb2coXCJ3cyBvcGVuOiBcIiwgd3MucmVhZHlTdGF0ZSlcclxuICAgICAgICAgICAgLy/lj5HpgIHlv4Pot7NcclxuICAgICAgICAgICAgSGVhcnRDaGVjay5yZXNldCgpLnN0YXJ0SGVhcnRCZWF0KClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHdzLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBuZXcgVWludDMyQXJyYXkoZS5kYXRhKVxyXG4gICAgICAgICAgICB2YXIgbXNnaWQgPSBkYXRhWzBdIFxyXG4gICAgICAgICAgICBzd2l0Y2ggKG1zZ2lkKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEdsb2JhbC5NSURfbG9naW46XHJcbiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZVN0YXRlRnVuYy5vbmxvZ2luKGRhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEdsb2JhbC5NSURfbG9nb3V0OlxyXG4gICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VTdGF0ZUZ1bmMub25sb2dvdXQoZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgR2xvYmFsLk1JRF9tb3ZlOlxyXG4gICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VTdGF0ZUZ1bmMub25tb3ZlKGRhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEdsb2JhbC5NSURfQnVtcDpcclxuICAgICAgICAgICAgICAgICAgICBNZXNzYWdlU3RhdGVGdW5jLm9uQnVtcChkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBjYXNlIEdsb2JhbC5NSURfSGVhcnRCZWF0OlxyXG4gICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VTdGF0ZUZ1bmMub25IZWFydEJlYXQoZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSBHbG9iYWwuTUlEX1N0YXJCb3JuOlxyXG4gICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VTdGF0ZUZ1bmMub25TdGFyQm9ybihkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBjYXNlIEdsb2JhbC5NSURfR006XHJcbiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZVN0YXRlRnVuYy5vbkdNKGRhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIGNhc2UgR2xvYmFsLk1JRF9PbmxpbmU0T3RoZXI6XHJcbiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZVN0YXRlRnVuYy5PbmxpbmU0T3RoZXIoZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSBHbG9iYWwuTUlEX1JlZ2lzdGVyOlxyXG4gICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VTdGF0ZUZ1bmMub25SZWdpc3RlcihkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBjYXNlIEdsb2JhbC5NSURfU3luY1BvczpcclxuICAgICAgICAgICAgICAgICAgICBNZXNzYWdlU3RhdGVGdW5jLm9uU3luY1BvcyhkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBjYXNlIEdsb2JhbC5NSURfTW9uc3RlckluZm86XHJcbiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZVN0YXRlRnVuYy5vbk1vbnN0ZXJJbmZvKGRhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIGNhc2UgR2xvYmFsLk1JRF9Mb2dpY0ZyYW1lU3luYzpcclxuICAgICAgICAgICAgICAgICAgICBNZXNzYWdlU3RhdGVGdW5jLm9uTG9naWNGcmFtZVN5bmMoZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBjYy5sb2coXCLmnKrnn6Ug5raI5oGvaWQ6IFwiLCBtc2dpZClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy/lj5HpgIHlv4Pot7NcclxuICAgICAgICAgICAgSGVhcnRDaGVjay5yZXNldCgpLnN0YXJ0SGVhcnRCZWF0KClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHdzLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBjYy5sb2coXCJ3cyBlcnJvcjogXCIsIHdzLnJlYWR5U3RhdGUpXHJcbiAgICAgICAgICAgIC8vR2xvYmFsLndzID0gbnVsbFxyXG4gICAgICAgICAgICBpZiAoSGVhcnRDaGVjay5oYXNEaXNjb25uZWN0ZWQoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgSGVhcnRDaGVjay5zdG9wUmVjb25uZWN0VGltZXIoKVxyXG4gICAgICAgICAgICAgICAgSGVhcnRDaGVjay5yZWNvbm5lY3RUaW1lb3V0b2JqID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnN3Q29ubmVjdCgpO1xyXG4gICAgICAgICAgICAgICAgfSwgMTAwMClcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBIZWFydENoZWNrLnN0b3BSZWNvbm5lY3RUaW1lcigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHdzLm9uY2xvc2UgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBjYy5sb2coXCJ3cyBjbG9zZTogXCIsIHdzLnJlYWR5U3RhdGUpXHJcbiAgICAgICAgICAgIC8vR2xvYmFsLndzID0gbnVsbFxyXG4gICAgICAgICAgICBpZiAoSGVhcnRDaGVjay5oYXNEaXNjb25uZWN0ZWQoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgSGVhcnRDaGVjay5zdG9wUmVjb25uZWN0VGltZXIoKVxyXG4gICAgICAgICAgICAgICAgSGVhcnRDaGVjay5yZWNvbm5lY3RUaW1lb3V0b2JqID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnN3Q29ubmVjdCgpO1xyXG4gICAgICAgICAgICAgICAgfSwgMTAwMClcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBIZWFydENoZWNrLnN0b3BSZWNvbm5lY3RUaW1lcigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNjLmxvZyhcImdsb2JhbCB3cyBpbml0LCBzdGF0ZTogXCIsIHdzLnJlYWR5U3RhdGUpXHJcbiAgICAgICAgR2xvYmFsLndzID0gd3NcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSB7Kn0gZGF0YSAg5YW35L2T5pWw5o2uLCAx77ya6ZW/5bqm77yMMu+8muaYr+WQpuW5v+aSre+8jDPvvJouLi4g5YW35L2T5raI5oGv5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIHNlbmR3c21lc3NhZ2U6IGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChHbG9iYWwud3MgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChHbG9iYWwud3MgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZiAoR2xvYmFsLndzLnJlYWR5U3RhdGUgPT0gV2ViU29ja2V0LkNMT1NFRCB8fCBHbG9iYWwud3MucmVhZHlTdGF0ZSA9PSBXZWJTb2NrZXQuQ0xPU0lORykgeyAvL+ato+WcqOaWreW8gOaIluiAheW3sue7j+aWreW8gO+8jOWImeS4jeiDveWPkemAgea2iOaBr1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vY2MubG9nKFwid3Mgc2VuZHdzbWVzc2FnZTogXCIsIEdsb2JhbC53cy5yZWFkeVN0YXRlKVxyXG4gICAgICAgIEdsb2JhbC53cy5zZW5kKGRhdGEpXHJcbiAgICB9XHJcbn0pIl19