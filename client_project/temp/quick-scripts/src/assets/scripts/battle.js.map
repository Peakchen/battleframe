{"version":3,"sources":["assets\\scripts\\battle.js"],"names":["Api","require","cc","Class","Component","properties","randseed","getApi","getHost","getRandNumber","number","Rand","postBattleStartMsg","log","request","loader","getXMLHttpRequest","url","open","setRequestHeader","onreadystatechange","readyState","status","parseInt","responseText","send","Uint16Array","postAttackMsg"],"mappings":";;;;;;AAAA,IAAIA,GAAG,GAAGC,OAAO,CAAC,KAAD,CAAjB;;AACAC,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE;AACRC,IAAAA,QAAQ,EAAE;AADF,GAHP;AAOL;AACAC,EAAAA,MAAM,EAAE,kBAAU;AACd,WAAO,IAAIP,GAAJ,EAAP;AACH,GAVI;AAYL;AACAQ,EAAAA,OAAO,EAAE,mBAAW;AAChB,WAAO,iBAAP;AACH,GAfI;AAiBL;AACAC,EAAAA,aAAa,EAAE,uBAASC,MAAT,EAAgB;AAC3B,QAAI,KAAKJ,QAAL,IAAiB,CAArB,EAAwB;AACpB,aAAOI,MAAP;AACH;;AACD,WAAO,KAAKH,MAAL,GAAcI,IAAd,CAAmBD,MAAnB,EAA2B,KAAKJ,QAAhC,CAAP;AACH,GAvBI;AAyBL;AACAM,EAAAA,kBAAkB,EAAE,8BAAW;AAC3B,QAAI,KAAKN,QAAL,GAAgB,CAApB,EAAuB;AACnB;AACH;;AAEDJ,IAAAA,EAAE,CAACW,GAAH,CAAO,kCAAP;AACA,QAAIC,OAAO,GAAGZ,EAAE,CAACa,MAAH,CAAUC,iBAAV,EAAd;AACA,QAAIC,GAAG,GAAG,KAAKT,OAAL,KAAiB,cAA3B;AACAM,IAAAA,OAAO,CAACI,IAAR,CAAa,MAAb,EAAqBD,GAArB,EAA0B,IAA1B;AACAH,IAAAA,OAAO,CAACK,gBAAR,CAAyB,cAAzB,EAAyC,0BAAzC;;AACAL,IAAAA,OAAO,CAACM,kBAAR,GAA6B,YAAU;AACnC,UAAIN,OAAO,CAACO,UAAR,IAAsB,CAAtB,IAA4BP,OAAO,CAACQ,MAAR,IAAkB,GAAlB,IAAyBR,OAAO,CAACQ,MAAR,GAAiB,GAA1E,EAAgF;AAC5E,aAAKhB,QAAL,GAAgBiB,QAAQ,CAACT,OAAO,CAACU,YAAT,CAAxB;AACAtB,QAAAA,EAAE,CAACW,GAAH,CAAO,YAAP,EAAqBC,OAAO,CAACU,YAA7B;AACH;AACJ,KALD;;AAOAV,IAAAA,OAAO,CAACW,IAAR,CAAa,IAAIC,WAAJ,CAAgB,CAAC,CAAD,CAAhB,CAAb,EAjB2B,CAiBQ;AACtC,GA5CI;AA8CL;AACAC,EAAAA,aAAa,EAAE,yBAAW;AACtBzB,IAAAA,EAAE,CAACW,GAAH,CAAO,4BAAP,EAAqC,KAAKJ,aAAL,CAAmB,CAAnB,CAArC;AACA,QAAIK,OAAO,GAAGZ,EAAE,CAACa,MAAH,CAAUC,iBAAV,EAAd;AACA,QAAIC,GAAG,GAAG,KAAKT,OAAL,KAAiB,SAA3B;AACAM,IAAAA,OAAO,CAACI,IAAR,CAAa,MAAb,EAAqBD,GAArB,EAA0B,IAA1B;AACAH,IAAAA,OAAO,CAACK,gBAAR,CAAyB,cAAzB,EAAyC,0BAAzC;;AACAL,IAAAA,OAAO,CAACM,kBAAR,GAA6B,YAAU;AACnC,UAAIN,OAAO,CAACO,UAAR,IAAsB,CAAtB,IAA4BP,OAAO,CAACQ,MAAR,IAAkB,GAAlB,IAAyBR,OAAO,CAACQ,MAAR,GAAiB,GAA1E,EAAgF;AAC5EpB,QAAAA,EAAE,CAACW,GAAH,CAAO,YAAP,EAAqBC,OAAO,CAACU,YAA7B;AACH;AACJ,KAJD;;AAMAV,IAAAA,OAAO,CAACW,IAAR,CAAa,IAAIC,WAAJ,CAAgB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,CAAhB,CAAb,EAZsB,CAYmB;AAC5C;AA5DI,CAAT","sourceRoot":"/","sourcesContent":["let Api = require(\"api\")\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        randseed: 0,\r\n    },\r\n\r\n    //\r\n    getApi: function(){\r\n        return new Api()\r\n    },\r\n\r\n    //获取地址端口\r\n    getHost: function() {\r\n        return \"127.0.0.1:13001\";\r\n    },\r\n\r\n    //获取随机数\r\n    getRandNumber: function(number){\r\n        if (this.randseed == 0) {\r\n            return number\r\n        }\r\n        return this.getApi().Rand(number, this.randseed);\r\n    },\r\n\r\n    //发送战斗开始请求\r\n    postBattleStartMsg: function() {\r\n        if (this.randseed > 0) {\r\n            return\r\n        }\r\n\r\n        cc.log(\"begin send battle start message.\")\r\n        var request = cc.loader.getXMLHttpRequest();\r\n        var url = this.getHost() + \"/BattleStart\"\r\n        request.open(\"POST\", url, true)\r\n        request.setRequestHeader(\"Content-Type\", \"text/plain;charset=UTF-8\");\r\n        request.onreadystatechange = function(){\r\n            if (request.readyState == 4 && (request.status >= 200 && request.status < 300)) {\r\n                this.randseed = parseInt(request.responseText)\r\n                cc.log(\"response: \", request.responseText)\r\n            }\r\n        } \r\n\r\n        request.send(new Uint16Array([1])) //param 1: 数据长度，param ...: 具体数据\r\n    },\r\n\r\n    //发送攻击请求\r\n    postAttackMsg: function() {\r\n        cc.log(\"begin send Attack message.\", this.getRandNumber(5))\r\n        var request = cc.loader.getXMLHttpRequest();\r\n        var url = this.getHost() + \"/Attack\"\r\n        request.open(\"POST\", url, true)\r\n        request.setRequestHeader(\"Content-Type\", \"text/plain;charset=UTF-8\");\r\n        request.onreadystatechange = function(){\r\n            if (request.readyState == 4 && (request.status >= 200 && request.status < 300)) {\r\n                cc.log(\"response: \", request.responseText)\r\n            }\r\n        } \r\n\r\n        request.send(new Uint16Array([3,1,2,3])) //param 1: 数据长度，param ...: 具体数据\r\n    }\r\n})\r\n\r\n"]}